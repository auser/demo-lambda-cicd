import { Head, Header, Footer } from "mdx-deck";
import Highlighter from "react-syntax-highlighter";
import { Notes, Split, Horizontal, Code, FullScreenCode } from "mdx-deck";
import { Invert } from "mdx-deck";
import { CodeSurfer, CodeSurferColumns, Step } from "code-surfer";
import { nightOwl } from "@code-surfer/themes";

import "./styles/deck.css";

import { presentation } from "../package.json";
import { Layout } from "./components/Layout";
import { Cover } from "./components/Cover";
import { Timeline } from "./components/Timeline";
import { TableOfContents } from "./components/TableOfContents";
import { Thanks } from "./components/Thanks";
import { Image } from "./components/Image";
import { ZeroPadding } from "./components/ZeroPadding";
import { BackgroundImage } from "./components/BackgroundImage";
import myTheme from "./theme";
export const theme = myTheme;

<Head>
  <title>CI/CD</title>
  <meta name="description" value="ci/cd" />
</Head>

<Footer>
  <img
    src="https://devops2020.com/wp-content/uploads/2019/05/AWS_logo_png.png"
    style={{
      position: "absolute",
      bottom: "10px",
      right: "10px",
      height: 80,
      width: 80,
    }}
  />
</Footer>

<Layout />

<Cover {...presentation} />

<Notes>

</Notes>

---

<Timeline data={presentation.steps} title="Today's topics" />

---

## Introduction

---

<BackgroundImage
  opacity="20%"
  src="https://media.giphy.com/media/xUPGcM9CazM9H5KrEA/giphy.gif"
/>

First, what is **CI/CD**?

---

<h2>Continuous Integration</h2>
<h2>Continuous Delivery</h2>

---

<BackgroundImage
  opacity="20%"
  src="https://media.giphy.com/media/r2MkQEOe7niGk/giphy.gif"
/>

## Continuous Delivery

---

Continuous Delivery is the practice of deploying our application with _every_ (**or not**) commit.

---

- Allows us to Continuously **Explore** and reinvent on-behalf of our customers
- Encourages experimentation
- Allows for deployment at _any time_ of day
- Releasing on behalf of our customers
- Launch anytime (yes, even in peak periods)

---

## Old days

---

- Everything gets packed into a single deployment
- Replace entire system with new codebase
- Deployment cycle includes testing, QA, sign-off, resulting in weeks
- Rollbacks... painful
- Iterations take weeks to months
- Application downtime ðŸ˜’

---

### _Maybe_ okay for 1998

---

<BackgroundImage
  opacity="20%"
  src="https://media.giphy.com/media/2g8EYDN0VWFMY/giphy.gif"
/>

### But not for 2020

<Appear>
  <small>Where are our flying cars, damnit?</small>
</Appear>

---

## Continuous delivery

---

## Continuous deployment

---

## Continuous release

---

Forget the risks of big, fat deployments when constantly deploying

---

<BackgroundImage
  opacity="20%"
  src="https://media.giphy.com/media/8tbgksQhlWCJy/giphy.gif"
/>

- New application components are gradually released
- Iterate over new pieces of code
- Deployment cycle is _automated_
- Rollbacks are a cinch
- Iteration time shrinks mimics development time
- Minimal to zero downtime

---

New deployment mechanisms

---

### Blue-green

<img
  src="https://res.cloudinary.com/practicaldev/image/fetch/s--w3h-zsYZ--/c_imagga_scale,f_auto,fl_progressive,h_420,q_auto,w_1000/https://thepracticaldev.s3.amazonaws.com/i/m664yyotixnqncprryf0.png"
  alt="Blue-green"
/>

---

<img
  src="https://static.packt-cdn.com/products/9781788837866/graphics/8bd6d0a8-43ec-43ca-90e1-2170815b658b.png"
  alt="A/B Testing"
/>

### A/B Testing

---

- Dark launches
- Feature toggling
- Selective deployment

---

Keys to continuous deployment:

- Deploy to production (or staging)
- Verify solution
- Setup automated monitoring and alerting
- Responding to failure

---

### Post-deployment

---

<BackgroundImage
  opacity="20%"
  src="https://media.giphy.com/media/uTfOt7RT9bMWs/giphy.gif"
/>

- Monitoring performance
- Monitoring user interaction
- Error handling
- Bugs

---

## But but but... to production?

---

## Continuous Integration

---

Continuous Integration is the practice of creating automated builds and tests every time we commit a change into our repository.

---

<BackgroundImage
  opacity="20%"
  src="https://media.giphy.com/media/yNs2a0jRkYxy6191B2/giphy.gif"
/>

Of course, this means we need to write tests

---

### Steps to CI

- Exploration
- Development
- Unit testing
- End-to-end testing
- Stage deployment

---

### Behavior-driven development

Develop with user-behavior in-mind, towards acceptance testing

---

### Test-driven or test-behind

Test driven requires the tests to be written before functional testing, while test-behind allows for an inverted process, still keeping in-mind testable code

---

<BackgroundImage
  opacity="20%"
  src="https://media.giphy.com/media/s3JaFSpVUKMp2/giphy.gif"
/>

### Version control drives deployment

---

### Coverage patterns

---

## Testing testing testing

---

### Did I say testing yet?

---

Commit often and use coverage and fuzzy testing to find edge-cases

---

Automate compilation and testing

---

<BackgroundImage
  opacity="20%"
  src="https://media.giphy.com/media/TqiwHbFBaZ4ti/giphy.gif"
/>

> How does my code break the rest?

---

Trunk-based development or feature/bug/fix branches for development with fast merging upon test success

---

End-to-end testing is highly critical

---

Allows us to keep expected workflows and removal of old workflows

---

Mirror production data in test environments

---

### Virtualization

---

### Deployment to staging

Keeping an environment on staging allows us to match production builds with validation environment that does not affect

---

## Continuous culture

- Integrate and test often
- Surface results
- Fix bugs and failed integrations fast
- Establish cadence of deployment
- Maintain proper infrastructure

---

<BackgroundImage
  src="https://media.giphy.com/media/8myYQ3otu4ipvM8McM/giphy.gif"
  opacity="40%"
/>

## Monitoring

---

Collect metrics and logs about performance

---

Monitoring is a big topic with lots of edges.

We'll talk about CloudWatch for lambda and EC2

---

### CloudWatch for Lambda Functions

---

When our resources changes state, we can automatically send CloudWatch events. Lambda functions can invoke or be invoked by CloudWatch events. We can also invoke on a schedule.

---

CloudWatch events can be set to trigger CloudWatch alarms based-upon a baseline workload, thresholding, anomaly detection, errors...

We can set up CloudWatch to trigger notifications on duration measurements, throttling, and even custom metrics

---

<BackgroundImage
  opacity="30%"
  src="https://media.giphy.com/media/l3nW1Qum1tgZQwhvq/giphy.gif"
/>

### CloudWatch on EC2

---

EC2 instances have built-in monitoring with CloudWatch

---

We can even set-up our instances to send out periodic metrics

---

## Questions?

---

<Thanks />
